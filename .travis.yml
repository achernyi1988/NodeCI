language: node_js
node_js:
  - '12'
dist: trusty
services:
  - mongodb
  - redis-server
env:
  matrix:
  - NODE_ENV=ci PORT=3000
  global:
  - secure: DT110CUlFTRXJKVk465za34m9xbBHavhTXNYVtyA354FlDy19DqtqJ3nT8x5PzuVcADK36BGmtXCIWW81f8xqvUCSJGvCl0eSKw66izqigxs/21JKCSK+K+h14ICWvjtFtLr18v0mGL4B9x/Ed7kYoIhSHuDaDJPbehdC6qnDXV/4ZMgp8KKSzXou3/F0cGWZSG2+Wff3yQuR9GxPUrnDnbTlwNEczc5p584V2eLn8okUDP8uNjDSAZr9r85OBg9kPUKilVV0lOx/blUPBKVZXTbE5XNBbH7T9ArxpRvUOWTQcjD+v0xyby3vzJu1i8DAZ28/8mY8pSapQ4FKqPhCsvi8Bs+LILP37PeoRnG0gEH5lsga+xDomEYa+K8Up9SKSHAt3WoMuA2rXs2jDDWHMStZ4YJ8sOUV2f3MpQsI/k06CkT7h00OYKKIdMXzJyLZPQ1dwBfexXJuIX+8Ln2qBJv2D9CM8dGWoZm0XI4fg1QsD3kf20n3yQf17CNTotnacK4YvWotCP18TJtt07VsngKCPgihFhtYk7rqCHxvNVG/JDClbJFTTGm2jp/+lcFOsw0+jIR/CeHF7OEtszXESP3PotoU0bYykYyCvfOS/5zBD64yjrAsjnuh0wMnM2LZkftHAZSThyNZAOvEez+/eooEMEowkBbCmlzE18dLC8=
  - secure: pH6K0TctXpCtr4jLa/hizWcgfbWmpoqmgHkwg+jdHISCBTgtOartdsC97moKFIYECcOG7/RXGodaB9bz3UytKU0IC/8Tdn3C28DgqxyxlMBUhVlUHHT97hicPB0XPO3QxemJMeok15WYlK5gDDHM2y0DrpXQ9XnP30emhc6wTZ0beEzeb7glgFMJqLfC8dIhr/aWE6ySXHB14la94HcoikK3v23KbYW5299Ppk3AoSj/JFxSoVG/1ZxM9tR0ocZ463q+kqS1l4AQgV46S9ys8BTl7i9k6Gc1hY19o0fuXGLpDjk5Rzka0ve37CIS81BQnUvFdCUM1t1OCMBDaiwLklS60hB/rWZ8sGOPgf1oibmwqr5dX8wXr79DgpHIo6+Gi3iWL4mbnW9hrp4I7lEcltui9D8FvXDWmWe9/pT5Ux80F3bXLlGKUEkTCQftNVN9HW9R3AUkmJu+yvXKefZbalkic8B7NH6p6nPoi2Qr54Gcd1iII+0yGPS/oLrDrjKuDyd+0PFLiz7rE3zYmNANpJVUrwwEwr3OZnNi3YCJ/skJwBx1MnEnNW+o26O1ovaTnJOiEJT7P92noh6K56O5rF9j30hPhQ+CvZx8ce5/itt9thvcmUsgBBSBrdEtY26l9eL9pefmP/K5swV7Leh8QwAbzqBxNuXiNdlJl03r/1k=
  - secure: xfs6pwJYrk7S77xdtE/wdLeNEjPeF5RNfje6wulAhZx8IQpF+ca22qD+IU9JI5xUy9apfk+7gM3LToS5dbhQP0QXZ5lxcnefoCtY8m4jenszhfzLujR8qoA2n16GMNHprP6MmxIq4ajTTnindxDU+hXqSemKoseZzjgKHaGXoUpusvgEB9p8LP2ZPGDE10zYQLq9cKtV4oJSGis0iz2zR174K+7T4/XsP2zIs9ah8utLpLP/UiSWUCPH0V8ZaSHwPtcW8r7SchbpAMP/CC9cJEt6FERtpqGvkPMTwYGgjafIQpI59WuLaJu3Q7yD0bTU3Ah8oBjhD/nQEdwiIzneD6Vxs7QErb6BA39Zbf+4zjjArJeHhzznY0SYu6+bShBojJ+kKpmUOyupIyVzP2oYxq02BoN6Rie7mX3cuShjd1MWM5bu9lDFTm+0AGlD9UwoXPahS03cl1Uax//CYMBUPpyJCJLT8X9uMq+3SPzTjpt16vQazPMudLsAyYNT/ON/S3J8HrtBVTuhYpqU2rm+IHJWEHABa5/FoLML0KYRIH8MojGv4hk2adSqfERhsp3f7rz5k1GvrvPlOdEZJS5B+1lPfHTtFFnohDT4VNLEvbidy1Oa4bVTRLYJxQrSk3B788/G5cwsdnjggcKB/F4zEb1wHl7+AHZp+o6PoVCpWRs=
  - secure: OIT378VySGVLceq4++D2ZU1g4ubh6QVaH/l+tA5E5AteRtRyD7KGtJnpxUwjunIc+PKgUoHkXd2WbYQaeiizuH+0Ho4IJn6mWIwTA7FZaZzChzEHtljYHy//sZQADyDUr31u8ghkLOAeglcJaNkI9L7LciUxfLm1BQlXUZj9Mero76xJ5V8CX9owpxc1gjTRKfR7hod51G8mDGB2K50gtCKAJfLVIo7l48ETlJHuTEkjW0e38YZMAp8pIPhuXuopL14gsOhkBJzx9jGdf8qMhpkv7Xt3apgF7vPjSaODaPQsVaS/SMmxYXJpb8Xm75M2nNNJQs5biR9iquPFDOArVcfA7GrDBhvLH2X66A5XlQ8p3Lu2L1bUaHOun+J4S0emG6iuhtUV3o89fl/nGTIJSExydQEZz73omiZqLfajuyIWWPwf3zgpmw/AUMGwqINxy6lMO6hN8HeMxHgpYGBFCOSDPbUtvi2OgprUsKcniCL4xIfYH+F9sMn5qkgZFQ1/dCeBlR53Vz20jPxlf8DNcRfB0WgSCU+j6WX/JeBpk1nCu/A9Y6EewbRROxTclwI+GMbLchOo41SbIfC+lnWH9fCPe5+HyIbQ/fAJfsmZsELmOk1IR0I6bPYpg8NoeatFYWkQs9JoOEcggwwZOP2D51UI+hH10tVM5841j8inIo4=
  - secure: l4laEUG3qHz7TLikSHdMAfQoW1MYT24/puMQWcTLJaQetbxqGM/hK6iChV0h7SqJobU0aQrk4VEjWlnsgQFABAxoVADc19OGxvmk5+j8s/pNAK/AxKlP3WeUnqSj/L0Y4qjEpHx7zWJnvw7bhtmJ5ytFx5MlkeDc6OtaSahiF14gFa75FKq2lLZOXA5d75fhKd7JCEKYJWqmxIHP4Vt3QctQzcGow5mHYcpJB042rZQ2n2RVOAzklf0Q5c60P0iUNcNXXCRkBE0quKtiTHWnpqYjhMgPphn4ZJr1E0eJxhIaOSf84BRbZcE+gWHrACUg2gJyeXiYz8480yVg0mZykVHk8t2VhZ1XGFj/ndqg94lT7eIi7AUNaBB6yWwh7tdrF4FE5SxvUCmcBaK2W7k3STh1EevZn6clr5v/UzZNARD4XB3xIZDqV2YAJl9ctDPfFIrp3DNHHXYn2rxXHUy1c6kn9rrHaU91wU1p6T5WXgVR0dutp6C2WAUwfL1HbLxqAXIkD24nINDSNXsl82u5oYsWUm6cUrRCr4EXdIPtCkPne3hvLVY9CEfbq/5Z4xrI3ivAN66DTQ0oGSAb3O7/MXLDKvqOghs0YD1zYAmSHDuhpIzSvgi/ZP31VUDSiuaLEj0ax0/aRTdWIYXHXifnPiLRuoSeHl+oWtMcq/L8+1c=
cache:
  directories:
    - node_modules
    - client/node_modules
install:
  - npm install
  - npm run build
script:
  - nohup npm run start &
  - sleep 3
  - npm run test_ci
